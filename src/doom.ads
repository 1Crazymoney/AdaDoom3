--                                                                                                                         
--                                                                     sd+  +mNMm/                                                                         
--                                                         +ys/o`-:sy:-NMNo hNNMMy//     -`                                                                
--                                                     ````dMysmmMMMMMNhmMMymNNMMMMo  -:+Nh.`                                                              
--                                           `.::::osshmmmmMMNMdMMMNNMMMNMMMMMMMMNN/ :NMMMMNh-                                                             
--                                      `.-ssdyhNNNNNMMMMMMMMMMMMNm+/++/.sNNMMMMMNMNydMMMMm+.`                                                             
--                                     //o//+hs://////++hdNNMMMMM:`   .  `.-yNNhNMMMMMMMMMh  -- .                                                          
--                                 .ossdyho+++ohhmMMNmmmss/-+ys++`    ` -    .. sMMMMMMMMMs   / `                                                          
--                               `oNm+-:         `-+ohMMMMMNdo     ::    -      `sNMNmMmMMm/  `                                                            
--                              .hMN+              -.o/++ymMMN.     -` ```-/      `:NMMyNMMMNho-                                                           
--                             .mNh`                 `:mdsossN+        -  ``   +.   +MMNMMMMMMMM/                                                          
--                            .yM:                     :hNMMNm   `.  .:        `   .+MMMMMd`dMMMy                                                          
--                           .dN/                        /MMMm   `/`                /MMMMMh/NdMMm/                                                         
--               -/s+mNmso. .mM/                          yMMMdo   .  -+     ::    +MMMMMMMMNydMdM/                                                        
--             -hN++ dMMMMNydN/                           `/MMMNs: `   o-  `` `    yMMMMMMMMMdsMmMN-                                                       
--            -mMM+:hMmNMMMMMs                              /NMMMNNNNNNydsss/.   :sMNmNhsMMMMdsddMM:                                                       
--            NMMMMs:.oNMMMMM/o//+y-          `.            .yMMMMMMMNy:`/yMMNyssMMMMMN+mMMMMMd/hMh+                                                       
--           sMMMMy./yMMMMMMy`` .://+/      `ydys:o:-      -NMMMMMMNh++hmNNMMMMMMMh+NMMMMMMMM+/.d/`                                                        
--           yMMMMmmNd+mMMMMd` `:o:/.`       `-ds:``      -mMMMMMdh-y:`-mMMMMMMMMMMdNmdMdMMMMo` my.                                                        
--           yMMMMMMm- -mNMMm`/s-/oNd-         :+:-:      sMMMMMmho` +mhMMMMN+ymMMMMN-`yMMMMMM`.dMs                                                        
--           yMMMMMMM+/ `:hN+  `.`...        :` .m/ms/   +MMMMmm+````dMMMm++- ``smNhNNydMMMMNNo./My                                                        
--           :MMMMMMMMNs``ym-                    ./hs/ `+NMMMMM/..ydmNMMM/   `` .`+sNMMMMMMMMMy`.+:                                                        
--            smNMMMMMMd:-dd                           sMMMMMd/  .mMMMMMM  ..   ` .MMMMMMMMNMMM:                                                           
--             .:hmMMMh+odMd                          :NMMMNms `soMMMMMMM+``.     oMNMMMMMMmNd+.                                                           
--                :NMMs`dMMm`                        `mMMMd::mh/MmMMMMMMMMh.-``..oNMmMMMMMMMh                                                              
--                 -mMNyNMMM+    `--..               :MMMM-``dMMMMMMMMMMMMMNdddmmMMMMMMMMMMMm.                                                             
--                  `yMMMMMMs     :Nh:              .mMMMMddhMMMMMMMMMMMMMMMMMMMMMMMMMMMNMMmy`                                                             
--                    /dNMMMM+    `--               /MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMm/hd+`                                                               
--                      -odNMN/   o/-...`           dMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMh//ho`                                                                
--                         :mMm/  .+d:::s/          hMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy++.                                                                   
--                          .yMd`  `:o+            :hNMMMMMMMMMMMMMMMMMMMMMMMMMMMMdo:                                                                      
--                         .ysmM+                `-yhhMMMMMMMMMMMMMMMMMMMMMMMMMMMd`                                                                        
--                     .`  +NMhhm`              -sNMMMMMMMMMMMMdMMMMMMMMMMMNMMMMMs        A  D  A   D  O  O  M    I I I                                             
--                    /MNd/ .N++Ms`            `yMMMMMMMhNMMMMMMMMMMMMMMMMMdNMMMN`                                                                         
--                 ..-hNNs-.dM+.hos/.``    `./+yyMmmMMNNy.oodMMMMMMMMMMMMMMMMMMMN`                                                                         
--                `dMd .` `sMso/hyyyMmmmmmhsshNNMM/+MMmyNymmMMMMMMMMNMMMMMMMMMMMMy                                                                         
--                -o/.  /::-y`/dN- .h/mdMMmdoydNMMmhmMmmMMdMMMMMMMMyNmoMMMMMMMMMMMs                                                                        
--                 /Ny-sy.``d-`so:o  `dMNsdNd:-hMMMMhMy:MMMMMMMMd:oyMNdMMMMMMMMMMMN/                                                                       
--                 /.hh` hdmNs: +dMs mMMN+-MMMNNMMNo-sNNMMMMMMdMhdMMMdyMMMMMMMMMMMMMo`                                                                     
--                   /.`yd:-- :/smhmhMMMho/MMMMNmMMMyMMMMMNssmohomyoydMyMMMMMMMdMMNhMh-                                                                    
--                      /. `y:s`+dhMMosMMMMMMMMd/yMMMMMMMm.`hd//dMms-NmmMNNMMMMMMMMdhhmo                                                                   
--                         oMd. `d+/NNhMMMmMMMMMMMMMMMMMm/+++dosmmh-hMddMMMMMMMMMMMmhmMMh`                                                                 
--                        +h/hh+yd-/NmMmNMNMMMMMMMMMmdNds+.ymymMdo` `hhNMNNMMMMMMdMNNNNmMm`                                                                
--                       .dmhh+-`NddMhyMNmMmMmNMMMNNMN+yMh`dy`+o`.  :yNMmmhMMMMMMMmMMMMMMMh-                                                               
--                      -:+Mo-o- MMyoyNMNdmmMMMMMMMMMm/Md/ s/`      `-smNMNMMMMMMMNMMMMMMMMy.                                                              
--                      -+/hdsdmsoo./ohMMh/dMMMMMMMms-:y.` ``ys`    .:ohNddMMMMMMMMMMMMMMMMMd.                                                             
--                     `sMNNmd-.shy+hN++yNNMMMMMMMN/  `+     ..     :+-:NhNMMMMMMmNMMMMMMmMMMo                                                             
--                    -yo:/s+:-.hmshNhmNMMMMMMMMd/-  //o               sMmsMMMMMMMMNmMMMMNMMMN/-                                                           
--                    +dMh+h/-dohmhNNMMMMMMMNso----  `              .:+ymMyMMMMMMMM+`yMhyMMMMMMNds.                                                        
--                 ` ` .s+ysm+hhoMMMMNmNMMd--   ..   :-.      `.  .:+ys+++ydMMMMMMdm.:yM-dMMMMdNmMh-                                                       
--                :: -sh:oho/h/mMMMMMysdm+`        `/soo      -s     `/` `ohdNMMMMNm+ -M-:ddMMmhmhmo-                                                      
--               /y.`omooddNh+:yMMhoMsy.` `        .`                    `smdmMMdMMMy -Mm-:hMMmmMhyo-`                                                     
--              .hd-soyNMmhNhhNMMs-sy+`   /    `             `/      ./.  yymNMMMMMMm..yMm``yMMhNh:..-                                                     
--             `s./yMMNMm::NMMNmmdNy          .h-..   .+:     ```   /my:. +MMmMMMMMMdd`+MMd:`hm-oh.s.`.`                                                   
--            .ddyMNmyyNMMdNNMydMh+.          :MNmN:  `:.     :++`   -   ./NddMMMMMMMm- mdM+ .s: -:                                                        
--           `oNmMM+  oNsmNNhMMsMNs           hhsso`   .`     /NNy.    `sNM+hyNMMMMMMMm-/hmh.``:/s/`o``-                                                   
--         `+hMNmh+` .mN:sd++NMMNhs`:   -:`        -  -smo    .+.      `hdMMosMMMmhMMMMo`:mdM/  +/+   .                                                    
--        .symMddd  -mMNd/-/hNho` .//     - ` ./   :o :o::              .MddsoNMMmNhNMMd:--mm-  yys                                                        
--      :+mo/::` `oodNmNo.hMs       ` ```  .- .yhh`/s-+:       /-:s/.    MMMdNMMMmNmNMMm/o.+/.  :`.                                                        
--    +hmohh-`-+ymsddhyMhNM:  -//`:oNhohm    ``/s+             o/+d.    :MMNMmMdMMMMMMN+` h-.+-                                                            
--   +NNsMm++yoos-sm/moNsyhs  ``yNmooss-  `-hdo:`           `: `::.     yMMmddMMdMMMoNm-o   :-                                                             
--  /d:../      -mh+sNs. .// .:o::oy:  `.oy/yms-do -` `    `y:-s/` `/` :hhNMNNhmoMMMdymhh   .                                                              
-- -h:`          -hodMs :oo/so-/::.-.+--s/++d-o-.y:+Nhd/    ``/m. /`/`   hdyhmmMMmNy+hdo-                                                                  
-- .`              `sNh.oym/-.-:so/ -:.    .ds-yh+  /mNo   :h://-`-o/    ydodhyMdMN/-ho:                                                                   
--                   -. oN+.ss/o:   -s.--   ``ooyho. .-     .:/-.- -s ` +s/+dhymds+-                                                                       
--                     `oo/: `./.`+   -    .``-..`` :.    .oos++`:  +so/:+/+mhhMd :.                                                                       
--                      .- .   ./.-      ./- :ss-`  ` ..   ``:..os. /oo-hh+mmmmMN .                                                                        
--                                          `+.      :+: . . `-/`    ..`:` .+shNs                                                                          
--                                    .      ` .-   `/` .. .+ .` `. -:      /y--                                                                           
--                                    `- `     .  - .s.  .-:/  -     -`    -`                                                                              
--                                      `os`   :`   ```  `./     .   ``                                                                                    
--                                       `-`   :`         ``     `                                                                                         
--                                             `   --                                                                                                      

with Ada.Text_IO;
with Ada.Wide_Text_IO;
with Ada.Chars.Latin_1;
with Ada.Unchecked_Conversion;
with Ada.Unchecked_Deallocation;
with Ada.Containers.Indefinite_Vectors;
with Ada.Containers.Indefinite_Hashed_Maps;
with Ada.Containers.Indefinite_Ordered_Maps;
with Ada.Containers.Indefinite_Multiway_Trees;
with Ada.Strs.Wide_Complex.Wide_Hash;
with Ada.Strs.Wide_Complex; use Ada.Strs.Wide_Complex;
with Ada.Strs.Wide_Fixed;     use Ada.Strs.Wide_Fixed;
with Ada.Strs.Complex;      use Ada.Strs.Complex;
with Ada.Strs.Fixed;          use Ada.Strs.Fixed;
with Ada.Strs;                use Ada.Strs;
with Ada.Streams;                use Ada.Streams;
with Ada.Calendar;               use Ada.Calendar;
with Ada.Containers;             use Ada.Containers;
with Ada.Exceptions;             use Ada.Exceptions;
with Interfaces.C;               use Interfaces.C;
with Interfaces;                 use Interfaces;
with System;                     use System;

package Doom is

  --------------------
  -- Standard_Types --
  --------------------

  subtype Stream_Element                  is Ada.Streams.Stream_Element;
  subtype Char_8_C                   is Interfaces.C.Char;
  subtype Char_8                     is Char;
  subtype Char_16_C                  is Interfaces.C.WChar_T;
  subtype Char_16                    is Wide_Char;
  subtype Str_8_C                      is Interfaces.C.Char_Array;
  subtype Str_8                        is Str;
  subtype Str_8_Complex              is Ada.Strs.Complex.Complex_Str;
  subtype Str_16_C                     is Interfaces.C.WChar_Array;
  subtype Str_16                       is Wide_Str;
  subtype Str_16_Complex             is Ada.Strs.Wide_Complex.Complex_Wide_Str;
  type    Int_Addr                 is mod MEMORY_SIZE;
  type    Int_8_Percent               is range 1..100; for Int_8_Percent'size use 64;
  subtype Int_8_Unsigned              is Unsigned_64;
  subtype Int_8_Unsigned_C            is Interfaces.C.Unsigned_Char;
  subtype Int_8_Signed                is Short_Short_Int;
  subtype Int_8_Signed_C              is Interfaces.C.Char;
  subtype Int_8_Natural               is Int_8_Unsigned;
  subtype Int_8_Positive              is Int_8_Unsigned range 1..Int_8_Unsigned'last;
  subtype Int_16_Unsigned             is Unsigned_16;
  subtype Int_16_Unsigned_C           is Interfaces.C.Unsigned_Short;
  subtype Int_16_Signed               is Short_Int;
  subtype Int_16_Signed_C             is Interfaces.C.Short;
  subtype Int_16_Natural           is Int_16_Unsigned;
  subtype Int_16_Positive          is Int_8_Unsigned range 1..Int_8_Unsigned'last;
  subtype Int_32_Unsigned          is Unsigned_32;
  subtype Int_32_Unsigned_C        is Interfaces.C.Unsigned;
  subtype Int_32_Signed            is Int;
  subtype Int_32_Signed_C          is Interfaces.C.Int;
  subtype Int_32_Natural           is Natural;
  subtype Int_32_Positive          is Positive;
  subtype Int_64_Unsigned          is Unsigned_32;
  subtype Int_64_Unsigned_C        is Int_64_Unsigned;
  subtype Int_64_Signed            is Long_Long_Int;
  subtype Int_64_Signed_C          is Int_64_Signed;
  subtype Int_64_Natural           is Int_64_Unsigned;
  subtype Int_64_Positive          is Int_64_Unsigned range 1..Int_64_Unsigned'last;
  subtype Int_Size_C               is Interfaces.C.Size_T;
  subtype Float_64_Real            is Long_Float;
  subtype Float_64_Real_C          is Interfaces.C.Double;
  subtype Float_64_Natural         is Float_64_Real range 0.0..Float_64_Real'last;
  subtype Float_64_Positive        is Float_64_Real range 1.0..Float_64_Real'last;
  subtype Float_64_Range           is Float_64_Real range -100.0..100.0;
  subtype Float_64_Percent         is Float_64_Real range 0.0..100.0;
  subtype Float_64_Degree          is Float_64_Real range 1.0..360.0;
  subtype Float_32_Real            is Float;
  subtype Float_32_Real_C          is Interfaces.C.C_Float;
  subtype Float_32_Natural         is Float_32_Real range 0.0..Float_32_Real'last;
  subtype Float_32_Positive        is Float_32_Real range 1.0..Float_32_Real'last;
  subtype Float_32_Range           is Float_32_Real range -100.0..100.0;
  subtype Float_32_Percent         is Float_32_Real range 0.0..100.0;
  subtype Float_32_Degree          is Float_32_Real range 1.0..360.0;
  type Ptr_Str_16                  is access all Str_16;
  type Ptr_Str_8_C                 is access all Str_8_C;
  type Ptr_Str_8                   is access all Str_8;
  type Ptr_Str_16_C                is access all Str_16_C;
  type Ptr_Int_Addr                is access all Int_Addr;
  type Ptr_Int_64_Unsigned_C       is access all Int_64_Unsigned_C;
  type Ptr_Int_32_Unsigned_C       is access all Int_32_Unsigned_C;
  type Ptr_Int_32_Unsigned         is access all Int_32_Unsigned;
  type Ptr_Int_32_Signed_C         is access all Int_32_Signed_C;
  type Ptr_Int_16_Unsigned_C       is access all Int_16_Unsigned_C;
  type Ptr_Int_8_Unsigned_C        is access all Int_8_Unsigned_C;
  type Ptr_Float_32_Real_C         is access all Float_32_Real_C;
  type Ptr_Char_8_C                is access all Interfaces.C.Char;
  type Ptr_Char_16_C               is access all Char_16_C;
  type Ptr_Const_Char_8_C          is access constant Char_8_C;
  type Ptr_Const_Char_16_C         is access constant Char_16_C;
  type Ptr_Const_Str_16_C          is access constant Str_16_C;
  type Ptr_Procedure               is access procedure;
  type Ptr_Function_Localize       is access function  (Item : Str_16) return Str_16;
  type Ptr_Procedure_Put           is access procedure (Item : Str_16);
  type Array_Stream_Element        is array (Positive range <>) of Stream_Element;
  type Array_Bool                  is array (Positive range <>) of Bool;
  type Array_Duration              is array (Positive range <>) of Duration;
  type Array_Addr                  is array (Positive range <>) of Addr;
  type Array_Ptr_Str_16            is array (Positive range <>) of Ptr_Str_16;
  type Array_Str_16_Complex        is array (Positive range <>) of Str_16_Complex;
  type Array_Char_8_C              is array (Positive range <>) of Char_8_C;
  type Array_Char_8                is array (Positive range <>) of Char_8;
  type Array_Char_16_C             is array (Positive range <>) of Char_16_C;
  type Array_Char_16               is array (Positive range <>) of Char_16;
  type Array_Int_Addr              is array (Positive range <>) of Int_Addr;
  type Array_Int_8_Unsigned_C      is array (Positive range <>) of Int_8_Unsigned_C;
  type Array_Int_8_Unsigned        is array (Positive range <>) of Int_8_Unsigned;
  type Array_Int_8_Signed_C        is array (Positive range <>) of Int_8_Signed_C;
  type Array_Int_8_Signed          is array (Positive range <>) of Int_8_Signed;
  type Array_Int_8_Natural         is array (Positive range <>) of Int_8_Natural;
  type Array_Int_8_Positive        is array (Positive range <>) of Int_8_Positive;
  type Array_Int_16_Unsigned_C     is array (Positive range <>) of Int_16_Unsigned_C;
  type Array_Int_16_Unsigned       is array (Positive range <>) of Int_16_Unsigned;
  type Array_Int_16_Signed_C       is array (Positive range <>) of Int_16_Signed_C;
  type Array_Int_16_Signed         is array (Positive range <>) of Int_16_Signed;
  type Array_Int_16_Natural        is array (Positive range <>) of Int_16_Natural;
  type Array_Int_16_Positive       is array (Positive range <>) of Int_16_Positive;
  type Array_Int_32_Unsigned_C     is array (Positive range <>) of Int_32_Unsigned_C;
  type Array_Int_32_Unsigned       is array (Positive range <>) of Int_32_Unsigned;
  type Array_Int_32_Signed_C       is array (Positive range <>) of Int_32_Signed_C;
  type Array_Int_32_Signed         is array (Positive range <>) of Int_32_Signed;
  type Array_Int_32_Natural        is array (Positive range <>) of Int_32_Natural;
  type Array_Int_32_Positive       is array (Positive range <>) of Int_32_Positive;
  type Array_Int_64_Unsigned       is array (Positive range <>) of Int_64_Unsigned;
  type Array_Int_64_Unsigned_C     is array (Positive range <>) of Int_64_Unsigned_C;
  type Array_Int_64_Signed         is array (Positive range <>) of Int_64_Signed;
  type Array_Int_64_Signed_C       is array (Positive range <>) of Int_64_Signed_C;
  type Array_Int_64_Natural        is array (Positive range <>) of Int_64_Natural;
  type Array_Int_64_Positive       is array (Positive range <>) of Int_64_Positive;
  type Array_Int_Size_C            is array (Positive range <>) of Int_Size_C;
  type Array_Float_64_Real_C       is array (Positive range <>) of Float_64_Real_C;
  type Array_Float_64_Real         is array (Positive range <>) of Float_64_Real;
  type Array_Float_64_Natural      is array (Positive range <>) of Float_64_Natural;
  type Array_Float_64_Positive     is array (Positive range <>) of Float_64_Positive;
  type Array_Float_64_Percent      is array (Positive range <>) of Float_64_Percent;
  type Array_Float_64_Degree       is array (Positive range <>) of Float_64_Degree;
  type Array_Float_32_Real_C       is array (Positive range <>) of Float_32_Real_C;
  type Array_Float_32_Real         is array (Positive range <>) of Float_32_Real;
  type Array_Float_32_Natural      is array (Positive range <>) of Float_32_Natural;
  type Array_Float_32_Positive     is array (Positive range <>) of Float_32_Positive;
  type Array_Float_32_Percent      is array (Positive range <>) of Float_32_Percent;
  type Array_Float_32_Degree       is array (Positive range <>) of Float_32_Degree;
  type Ptr_Array_Addr              is access all Array_Addr;
  type Ptr_Array_Ptr_Str_16        is access all Array_Ptr_Str_16;
  type Ptr_Array_Str_16_Complex    is access all Array_Str_16_Complex;
  type Ptr_Array_Char_8_C          is access all Array_Char_8_C;
  type Ptr_Array_Char_8            is access all Array_Char_8;
  type Ptr_Array_Char_16_C         is access all Array_Char_16_C;
  type Ptr_Array_Char_16           is access all Array_Char_16;
  type Ptr_Array_Int_8_Unsigned_C  is access all Array_Int_8_Unsigned_C;
  type Ptr_Array_Int_8_Unsigned    is access all Array_Int_8_Unsigned;
  type Ptr_Array_Int_8_Signed_C    is access all Array_Int_8_Signed_C;
  type Ptr_Array_Int_8_Signed      is access all Array_Int_8_Signed;
  type Ptr_Array_Int_8_Natural     is access all Array_Int_8_Natural;
  type Ptr_Array_Int_8_Positive    is access all Array_Int_8_Positive;
  type Ptr_Array_Int_16_Unsigned_C is access all Array_Int_16_Unsigned_C;
  type Ptr_Array_Int_16_Unsigned   is access all Array_Int_16_Unsigned;
  type Ptr_Array_Int_16_Signed_C   is access all Array_Int_16_Signed_C;
  type Ptr_Array_Int_16_Signed     is access all Array_Int_16_Signed;
  type Ptr_Array_Int_16_Natural    is access all Array_Int_16_Natural;
  type Ptr_Array_Int_16_Positive   is access all Array_Int_16_Positive;
  type Ptr_Array_Int_32_Unsigned_C is access all Array_Int_32_Unsigned_C;
  type Ptr_Array_Int_32_Unsigned   is access all Array_Int_32_Unsigned;
  type Ptr_Array_Int_32_Signed_C   is access all Array_Int_32_Signed_C;
  type Ptr_Array_Int_32_Signed     is access all Array_Int_32_Signed;
  type Ptr_Array_Int_32_Natural    is access all Array_Int_32_Natural;
  type Ptr_Array_Int_32_Positive   is access all Array_Int_32_Positive;
  type Ptr_Array_Int_64_Unsigned   is access all Array_Int_64_Unsigned;
  type Ptr_Array_Int_64_Unsigned_C is access all Array_Int_64_Unsigned_C;
  type Ptr_Array_Int_64_Signed     is access all Array_Int_64_Signed;
  type Ptr_Array_Int_64_Signed_C   is access all Array_Int_64_Signed_C;
  type Ptr_Array_Int_64_Natural    is access all Array_Int_64_Natural;
  type Ptr_Array_Int_64_Positive   is access all Array_Int_64_Positive;
  type Ptr_Array_Int_Size_C        is access all Array_Int_Size_C;
  type Ptr_Array_Float_64_Real_C   is access all Array_Float_64_Real_C;
  type Ptr_Array_Float_64_Real     is access all Array_Float_64_Real;
  type Ptr_Array_Float_64_Natural  is access all Array_Float_64_Natural;
  type Ptr_Array_Float_64_Positive is access all Array_Float_64_Positive;
  type Ptr_Array_Float_64_Percent  is access all Array_Float_64_Percent;
  type Ptr_Array_Float_64_Degree   is access all Array_Float_64_Degree;
  type Ptr_Array_Float_32_Real_C   is access all Array_Float_32_Real_C;
  type Ptr_Array_Float_32_Real     is access all Array_Float_32_Real;
  type Ptr_Array_Float_32_Natural  is access all Array_Float_32_Natural;
  type Ptr_Array_Float_32_Positive is access all Array_Float_32_Positive;
  type Ptr_Array_Float_32_Percent  is access all Array_Float_32_Percent;
  type Ptr_Array_Float_32_Degree   is access all Array_Float_32_Degree;

  -----------
  -- Color --
  -----------

  type Color_State is record
      Red   : Int_8_Unsigned;
      Green : Int_8_Unsigned;
      Blue  : Int_8_Unsigned;
    end record;
  COLOR_RED          : constant Color_State := (16#FF#, 16#00#, 16#00#);
  COLOR_TAN          : constant Color_State := (16#D2#, 16#B4#, 16#8C#);
  COLOR_BLUE         : constant Color_State := (16#00#, 16#00#, 16#FF#);
  COLOR_PINK         : constant Color_State := (16#FF#, 16#C0#, 16#CB#);
  COLOR_AQUA         : constant Color_State := (16#00#, 16#FF#, 16#FF#);
  COLOR_GRAY         : constant Color_State := (16#80#, 16#80#, 16#80#);
  COLOR_CYAN         : constant Color_State := (16#00#, 16#FF#, 16#FF#);
  COLOR_TEAL         : constant Color_State := (16#00#, 16#80#, 16#80#);
  COLOR_LIME         : constant Color_State := (16#BF#, 16#FF#, 16#00#);
  COLOR_PUCE         : constant Color_State := (16#CC#, 16#88#, 16#99#);
  COLOR_PLUM         : constant Color_State := (16#84#, 16#31#, 16#79#);
  COLOR_MAUVE        : constant Color_State := (16#E0#, 16#B0#, 16#FF#);
  COLOR_BLACK        : constant Color_State := (16#00#, 16#00#, 16#00#);
  COLOR_WHITE        : constant Color_State := (16#FF#, 16#FF#, 16#FF#);
  COLOR_GREEN        : constant Color_State := (16#00#, 16#FF#, 16#00#);
  COLOR_KHAKI        : constant Color_State := (16#C3#, 16#B0#, 16#91#);
  COLOR_IVORY        : constant Color_State := (16#FF#, 16#FF#, 16#F0#);
  COLOR_BEIGE        : constant Color_State := (16#F5#, 16#F5#, 16#DC#);
  COLOR_WHEAT        : constant Color_State := (16#F5#, 16#DE#, 16#B3#);
  COLOR_CORAL        : constant Color_State := (16#FF#, 16#7F#, 16#50#);
  COLOR_OLIVE        : constant Color_State := (16#80#, 16#80#, 16#00#);
  COLOR_SILVER       : constant Color_State := (16#C0#, 16#C0#, 16#C0#);
  COLOR_YELLOW       : constant Color_State := (16#FF#, 16#FF#, 16#00#);
  COLOR_ORANGE       : constant Color_State := (16#FF#, 16#A5#, 16#00#);
  COLOR_VIOLET       : constant Color_State := (16#EE#, 16#82#, 16#EE#);
  COLOR_PURPLE       : constant Color_State := (16#80#, 16#00#, 16#80#);
  COLOR_SALMON       : constant Color_State := (16#FA#, 16#80#, 16#72#);
  COLOR_INDIGO       : constant Color_State := (16#4B#, 16#00#, 16#82#);
  COLOR_MAROON       : constant Color_State := (16#80#, 16#00#, 16#00#);
  COLOR_GOLDEN       : constant Color_State := (16#FF#, 16#D7#, 16#00#);
  COLOR_MAGENTA      : constant Color_State := (16#FF#, 16#00#, 16#FF#);
  COLOR_FUCHSIA      : constant Color_State := (16#FF#, 16#77#, 16#FF#);
  COLOR_CRIMSON      : constant Color_State := (16#DC#, 16#14#, 16#3C#);
  COLOR_LAVENDER     : constant Color_State := (16#B5#, 16#7E#, 16#DC#);
  COLOR_SKY_BLUE     : constant Color_State := (16#87#, 16#CE#, 16#EB#);
  COLOR_CHARCOAL     : constant Color_State := (16#46#, 16#46#, 16#46#);
  COLOR_HOT_PINK     : constant Color_State := (16#FC#, 16#0F#, 16#C0#);
  COLOR_GOLDENROD    : constant Color_State := (16#DA#, 16#A5#, 16#20#);
  COLOR_NAVY_BLUE    : constant Color_State := (16#00#, 16#00#, 16#80#);
  COLOR_LIGHT_BLUE   : constant Color_State := (16#AD#, 16#D8#, 16#E6#);
  COLOR_ROYAL_BLUE   : constant Color_State := (16#08#, 16#4C#, 16#9E#);
  COLOR_AQUAMARINE   : constant Color_State := (16#7F#, 16#FF#, 16#D4#);
  COLOR_CHARTREUSE   : constant Color_State := (16#7F#, 16#FF#, 16#00#);
  COLOR_FOREST_GREEN : constant Color_State := (16#22#, 16#8B#, 16#22#);

  ------------
  -- Status --
  ------------

  protected type Protected_Status is
      function Is_Doing_Something return Bool;
      procedure Set_Is_Doing_Something (Value : Bool);
    private
      Status : Bool := False;
    end Protected_Status;

  --------------------------
  -- Protected_Containers --
  --------------------------

  generic
    type Tree_T is private;
  package Trees is
      package Unprotected is new Ada.Containers.Indefinite_Multiway_Trees (Tree_T, "=");
      subtype Cursor is Unprotected.Cursor;
      NO_ELEMENT : Cursor := Unprotected.NO_ELEMENT;
      protected type Protected_Tree is
          procedure Clear                                                                                 is begin Clear (Data);                                                   end;
          procedure Set        (Vector   : Vector)                                                        is begin Data := Vector;                                                 end;
          procedure Next       (Position : in out Cursor)                                                 is begin Next            (Position);                                     end;
          procedure Replace    (Position :        Cursor; New_Item : Vec_T)                               is begin Replace_Element (Data, Position, New_Item);                     end; 
          procedure Append                               (New_Item : Vec_T; Count : Int_32_Positive := 1) is begin Append          (Data,           New_Item, Count_Type (Count)); end;
          procedure Prepend                              (New_Item : Vec_T; Count : Int_32_Positive := 1) is begin Prepend         (Data,           New_Item, Count_Type (Count)); end;
          procedure Insert     (Before : Int_32_Positive; New_Item : Vec_T; Count : Int_32_Positive := 1) is begin Insert          (Data, Before,   New_Item, Count_Type (Count)); end;
          procedure Delete     (Index  : Int_32_Positive;                   Count : Int_32_Positive := 1) is begin Delete          (Data, Count);                                  end;
          function Element     (Index  : Int_32_Positive) return Vec_T                                    is (Element       (Data, Index));
          function Element     (Position : Cursor)        return Vec_T                                    is (Element       (Position));
          function Has_Element (Position : Cursor)        return Bool                                  is (Has_Element   (Position));
          function First                                  return Cursor                                   is (First         (Data));
          function Length                                 return Int_32_Positive                          is (Int_32_Positive (Length (Data)));
          function Get                                    return Vector                                   is (Data);
          procedure Clear
          procedure Iterate         (Parent : Cursor; Process : not null access procedure (Position : Cursor));
          procedure Reverse_Iterate (Parent : Cursor; Process : not null access procedure (Position : Cursor));
          procedure Prepend         (Parent : Cursor;         New_Item : Tree_T; Count : Int_32_Positive := 1);
          procedure Append          (Parent : Cursor;         New_Item : Tree_T; Count : Int_32_Positive := 1);
          procedure Insert          (Parent, Before : Cursor; New_Item : Tree_T; Count : Int_32_Positive := 1; Position : out Cursor);
          procedure Copy_Subtree    (Parent, Before, Source : Cursor);
          procedure Splice          (Parent, Before, Source : Cursor; Source_Tree : in out Tree);
          function Next             (Position    : Cursor) return Cursor;
          function Previous         (Position    : Cursor) return Cursor;
          function Parent           (Position    : Cursor) return Cursor;
          function Is_Root          (Position    : Cursor) return Bool;
          function Is_Leaf          (Position    : Cursor) return Bool;
          function Has_Element      (Position    : Cursor) return Bool;
          function Subtree_Nodes    (Position    : Cursor) return Int_32_Positive;
          function First            (Parent      : Cursor) return Cursor;
          function First            (Parent      : Cursor) return Tree_T;
          function Last             (Parent      : Cursor) return Tree_T;
          function Last             (Parent      : Cursor) return Cursor;
          function "="              (Left, Right : Cursor) return Bool;
          function "="              (Left, Right : Tree)   return Bool;
          function Is_Empty                                return Bool;
          function Nodes                                   return Int_32_Positive;
          function Root                                    return Cursor;
        private
          use Unprotected;
          Data : Vector;
        end;
    end;
  generic
    type Type_To_Vector is private;
  package Vectors is
      package Unprotected is new Ada.Containers.Indefinite_Vectors (Int_32_Positive, Type_To_Vector);
      subtype Cursor is Unprotected.Cursor;
      NO_ELEMENT : Cursor := Unprotected.NO_ELEMENT;
      protected type Protected_Vector is
          procedure Clear;
          procedure Set        (Data : Unprotected.Vector);
          procedure Next       (Position : in out Cursor);
          procedure Replace    (Position :        Cursor; New_Item : Type_To_Vector);
          procedure Append                               (New_Item : Type_To_Vector; Count : Int_32_Positive := 1);
          procedure Prepend                              (New_Item : Type_To_Vector; Count : Int_32_Positive := 1);
          procedure Insert     (Before : Int_32_Positive; New_Item : Type_To_Vector; Count : Int_32_Positive := 1);
          procedure Delete     (Index  : Int_32_Positive;                            Count : Int_32_Positive := 1);
          function Element     (Index  : Int_32_Positive) return Type_To_Vector;
          function Element     (Position : Cursor)        return Type_To_Vector;
          function Has_Element (Position : Cursor)        return Bool;
          function First                                  return Cursor;
          function Length                                 return Int_32_Positive;
          function Get                                    return Unprotected.Vector;
        end;
    end;
  generic
    type Map_T is private;
  package Hashed_Maps is
      package Unprotected is new Ada.Containers.Indefinite_Hashed_Maps (Str_16_Complex, Map_T, Wide_Hash, "="); 
      subtype Cursor is Unprotected.Cursor;
      NO_ELEMENT : Cursor := Unprotected.NO_ELEMENT;
      protected type Protected_Map is
          procedure Clear;
          procedure Set        (Data : Unprotected.Map);
          procedure Next       (Position : in out Cursor);
          procedure Delete     (Position : in out Cursor);
          procedure Replace    (Position :        Cursor; New_Item : Map_T);
          procedure Replace    (Key : Str_16;             New_Item : Map_T);
          procedure Insert     (Key : Str_16;             New_Item : Map_T);
          procedure Delete     (Key : Str_16);
          function Element     (Key : Str_16)      return Map_T;
          function Element     (Position : Cursor) return Map_T;
          function Has_Element (Key : Str_16)      return Bool;
          function Has_Element (Position : Cursor) return Bool;
          function Key         (Position : Cursor) return Str_16;
          function First                           return Cursor;
          function Get                             return Unprotected.Map;
        end;
      protected body Protected_Map is
          use Unprotected;
          Data : Map;
          procedure Clear                                            is begin Clear (Data);                                                 end;
          procedure Set        (Map : Map)                           is begin Data     := Map;                                              end;
          procedure Next       (Position : in out Cursor)            is begin Position := Next (Position);                                  end;
          procedure Delete     (Position : in out Cursor)            is begin Delete           (Data, Position);                            end;
          procedure Replace    (Position : Cursor; New_Item : Map_T) is begin Replace_Element  (Data, Position, New_Item);                  end;
          procedure Replace    (Key : Str_16;      New_Item : Map_T) is begin Replace          (Data, To_Str_16_Unbounded (Key), New_Item); end;
          procedure Insert     (Key : Str_16;      New_Item : Map_T) is begin Insert           (Data, To_Str_16_Unbounded (Key), New_Item); end;
          procedure Delete     (Key : Str_16)                        is begin Delete           (Data, To_Str_16_Unbounded (Key));           end;
          function Element     (Key : Str_16)      return Map_T      is       (Element         (Data, To_Str_16_Unbounded (Key)));
          function Element     (Position : Cursor) return Map_T      is       (Element         (Position));
          function Has_Element (Key : Str_16)      return Bool       is       (Has_Element     (Find (Data, To_Str_16_Object (Key))));
          function Has_Element (Position : Cursor) return Bool       is       (Has_Element     (Position));
          function Key         (Position : Cursor) return Str_16     is       (To_Str_16       (Key (Position)));
          function First                           return Cursor     is       (First           (Data));
          function Get                             return Map        is       (Data);
        end;
    end;


  package body Trees is
      protected body Protected_Tree is
          use Unprotected;
          Data : Tree;
          procedure Clear                                                                                      is begin Clear (Data); end;
          procedure Iterate         (Parent : Cursor; Process : not null access procedure (Position : Cursor)) is begin Iterate (Data, Process); end;
          procedure Reverse_Iterate (Parent : Cursor; Process : not null access procedure (Position : Cursor)) is begin Reverse_Iterate_Children (Parent, Process); end;
          procedure Prepend         (Parent : Cursor;                   New_Item : Type_To_Tree)               is begin Prepend_Child (Data, Parent, New_Item, Count_Type (Count)); end;
          procedure Append          (Parent : Cursor;                   New_Item : Type_To_Tree)               is begin Append_Child (Data, Parent, New_Item, Count_Type (Count)); end;
          procedure Insert          (Parent, Before, Position : Cursor; New_Item : Type_To_Tree)               is begin ; end;
          procedure Splice          (Parent, Before, Source   : Cursor; Source_Tree : in out Tree)             is begin ; end;
          procedure Copy_Subtree    (Parent, Before, Source   : Cursor)                                        is begin ; end;
          function First            (Parent      : Cursor) return Cursor                                       is ();
          function First            (Parent      : Cursor) return Type_To_Tree                                 is ();
          function Last             (Parent      : Cursor) return Type_To_Tree                                 is ();
          function Last             (Parent      : Cursor) return Cursor                                       is ();
          function Next             (Position    : Cursor) return Cursor                                       is (Next_Sibling (Position));
          function Previous         (Position    : Cursor) return Cursor                                       is (Previous_Sibling (Position));
          function Parent           (Position    : Cursor) return Cursor                                       is ();
          function Is_Root          (Position    : Cursor) return Bool                                      is ();
          function Is_Leaf          (Position    : Cursor) return Bool                                      is ();
          function Has_Element      (Position    : Cursor) return Bool                                      is (Has_Element (Position));
          function Subtree_Nodes    (Position    : Cursor) return Int_32_Positive                          is (Int_32_Positive (Subtree_Node_Count (Position)));
          function "="              (Left, Right : Cursor) return Bool                                      is (Equal_Subtree (Left, Right));
          function "="              (Left, Right : Tree)   return Bool                                      is ();
          function Is_Empty                                return Bool                                      is (Is_Empty (Data));
          function Nodes                                   return Int_32_Positive                          is ();
          function Root                                    return Cursor                                       is ();
        end;
    end;
  package body Ordered_Maps is
      protected body Protected_Map is
          use Unprotected;
          Data : Map;
          procedure Clear                                                  is begin Clear (Data);                                end;
          procedure Set        (Map : Map)                                 is begin Data     := Map;                             end;
          procedure Next       (Position : in out Cursor)                  is begin Position := Next (Position);                 end;
          procedure Delete     (Position : in out Cursor)                  is begin Delete           (Data, Position);           end;
          procedure Replace    (Position : Cursor; New_Item : Map_T) is begin Replace_Element  (Data, Position, New_Item); end;
          procedure Replace    (Key : Key_T; New_Item : Map_T) is begin Replace          (Data, Key, New_Item);      end;
          procedure Insert     (Key : Key_T; New_Item : Map_T) is begin Insert           (Data, Key, New_Item);      end;
          procedure Delete     (Key : Key_T)                         is begin Delete           (Data, Key);                end;
          function Element     (Key : Key_T) return Map_T      is (Element        (Data, Key));
          function Element     (Position : Cursor) return Map_T      is (Element        (Position));
          function Has_Element (Key : Key_T) return Bool          is (Has_Element    (Find (Data, Key)));
          function Has_Element (Position : Cursor) return Bool          is (Has_Element    (Position));
          function Key         (Position : Cursor) return Key_T      is (Key            (Position));
          function First                           return Cursor           is (First          (Data));
          function Get                             return Map              is (Data);
        end;
    end;
  generic
    type Key_T is (<>);
    type Map_T is private;
  package Ordered_Maps is
      package Unprotected is new Ada.Containers.Indefinite_Ordered_Maps (Key_T, Map_T, "<", "=");
      subtype Cursor is Unprotected.Cursor;
      NO_ELEMENT : Cursor := Unprotected.NO_ELEMENT;
      protected type Protected_Map is
          procedure Clear;
          procedure Set        (Data : Unprotected.Map);
          procedure Next       (Position : in out Cursor);
          procedure Delete     (Position : in out Cursor);
          procedure Replace    (Position : Cursor; New_Item : Map_T);
          procedure Delete     (Key : Key_T);
          procedure Insert     (Key : Key_T; New_Item : Map_T);
          procedure Replace    (Key : Key_T; New_Item : Map_T);
          function Element     (Key : Key_T) return Map_T;
          function Element     (Position : Cursor) return Map_T;
          function Has_Element (Key : Key_T) return Bool;
          function Has_Element (Position : Cursor) return Bool;
          function Key         (Position : Cursor) return Key_T;
          function First                           return Cursor;
          function Get                             return Unprotected.Map;
        end;
    end;

  -------------------------
  -- Addr_Conversions --
  -------------------------

  function To_Ptr_Int_16_Unsigned_C is new Ada.Unchecked_Conversion (Addr,               Ptr_Int_16_Unsigned_C);
  function To_Ptr_Int_16_Unsigned_C is new Ada.Unchecked_Conversion (Int_Addr,           Ptr_Int_16_Unsigned_C);
  function To_Ptr_Int_32_Unsigned   is new Ada.Unchecked_Conversion (Addr,               Ptr_Int_32_Unsigned);
  function To_Ptr_Char_8_C          is new Ada.Unchecked_Conversion (Addr,               Ptr_Char_8_C);
  function To_Ptr_Char_16_C         is new Ada.Unchecked_Conversion (Addr,               Ptr_Char_16_C);
  function To_Ptr_Const_Char_8_C    is new Ada.Unchecked_Conversion (Addr,               Ptr_Const_Char_8_C);
  function To_Ptr_Const_Char_16_C   is new Ada.Unchecked_Conversion (Addr,               Ptr_Const_Char_16_C);
  function To_Ptr_Const_Char_16_C   is new Ada.Unchecked_Conversion (Int_Addr,           Ptr_Const_Char_16_C);
  function To_Addr               is new Ada.Unchecked_Conversion (Ptr_Const_Char_16_C,   Addr);
  function To_Addr               is new Ada.Unchecked_Conversion (Int_Addr,           Addr);
  function To_Int_32_Unsigned_C     is new Ada.Unchecked_Conversion (Int_32_Signed_C,       Int_32_Unsigned_C);
  function To_Int_32_Unsigned       is new Ada.Unchecked_Conversion (Int_32_Signed_C,       Int_32_Unsigned);
  function To_Int_32_Unsigned       is new Ada.Unchecked_Conversion (Float_32_Real,         Int_32_Unsigned);
  function To_Int_32_Signed_C       is new Ada.Unchecked_Conversion (Int_32_Unsigned_C,     Int_32_Signed_C);
  function To_Int_32_Signed         is new Ada.Unchecked_Conversion (Int_32_Unsigned,       Int_32_Signed);
  function To_Int_16_Signed         is new Ada.Unchecked_Conversion (Int_16_Unsigned,       Int_16_Signed);
  function To_Int_16_Signed_C       is new Ada.Unchecked_Conversion (Int_16_Unsigned,       Int_16_Signed_C);
  function To_Int_16_Unsigned       is new Ada.Unchecked_Conversion (Char_16_C,             Int_16_Unsigned);
  function To_Int_Addr           is new Ada.Unchecked_Conversion (Ptr_Int_16_Unsigned_C, Int_Addr);
  function To_Int_Addr           is new Ada.Unchecked_Conversion (Ptr_Const_Char_16_C,   Int_Addr);
  function To_Int_Addr           is new Ada.Unchecked_Conversion (Ptr_Const_Char_8_C,    Int_Addr);
  function To_Int_Addr           is new Ada.Unchecked_Conversion (Addr,               Int_Addr);
  function To_Float_32_Real         is new Ada.Unchecked_Conversion (Float_32_Real,         Int_32_Unsigned);

  ------------------------
  -- Str_Conversions --
  ------------------------

  generic
    type Type_Number is mod <>;
  function Generic_To_Str_1 (Item : Type_Number; Base : Int_32_Positive; Do_Pad_Zeros : Bool := True) return Str_16;

  function To_Str_8               (Item : Str_8_C)            return Str_8               is (To_Ada                       (Item, True));
  function To_Str_8_C             (Item : Str_8)              return Str_8_C             is (To_C                         (Item, True));
  function To_Str_16_C            (Item : Str_16)             return Str_16_C            is (To_C                         (Item & NULL_CHAR_16));
  function To_Str_16_C            (Item : Str_16_Complex)     return Str_16_C            is (To_Str_16_C                  (To_Str_16 (Item)));
  function To_Str_16              (Item : Char_16)            return Str_16              is                               ("" & Item);
  function To_Str_16              (Item : Char_8)             return Str_16              is (To_Str_16                    ("" & Item));
  function To_Str_16              (Item : Str_8_C)            return Str_16              is (To_Str_16                    (To_Str_8 (Item)));
  function To_Str_16              (Item : Ptr_Const_Char_8_C) return Str_16              is (To_Str_16                    (To_Str_8 (Item)));
  function To_Str_16_Complex      (Item : Char_16)            return Str_16_Complex      is (To_Str_16_Complex            ("" & Item));
  function To_Ptr_Char_8_C        (Item : Str_8_C)            return Ptr_Char_8_C        is (To_Ptr_Char_8_C              (Item (Item'First)'Addr));
  function To_Ptr_Char_16_C       (Item : Str_16)             return Ptr_Char_16_C       is (To_Ptr_Char_16_C             (To_Str_16_C (Item)'Addr));
  function To_Ptr_Const_Char_16_C (Item : Str_16_Complex)     return Ptr_Const_Char_16_C is (To_Ptr_Const_Char_16_C       (To_Str_16 (Item)));
  function To_Ptr_Const_Char_16_C (Item : Str_16_C)           return Ptr_Const_Char_16_C is (To_Ptr_Const_Char_16_C       (Item (Item'First)'Addr));
  function To_Ptr_Const_Char_16_C (Item : Str_16)             return Ptr_Const_Char_16_C is (To_Ptr_Const_Char_16_C       (To_C (Item)));
  function To_Ptr_Const_Char_8_C2 (Item : Str_8_C)            return Ptr_Const_Char_8_C  is (To_Ptr_Const_Char_8_C        (Item (Item'First)'Addr));
  function To_Ptr_Const_Char_8_C  (Item : Str_8)              return Ptr_Const_Char_8_C  is (To_Ptr_Const_Char_8C2        (To_C (Item)));
  function To_Char_8_C            (Item : Char_16_C)          return Char_8_C            is (To_Char_8_C   (To_Char_8     (To_Char_16 (Item))));
  function To_Char_8_C            (Item : Char_16)            return Char_8_C            is (To_Char_8_C   (To_Char_8     (Item)));
  function To_Char_8_C            (Item : Char_8)             return Char_8_C            is (Char_8_C'Val  (Char_8'Pos    (Item)));
  function To_Char_8              (Item : Char_8_C)           return Char_8              is (Char_8'Val    (Char_8_C'Pos  (Item)));
  function To_Char_8              (Item : Char_16_C)          return Char_8              is (To_Char_8     (To_Char_16    (Item)));
  function To_Char_16_C           (Item : Char_16)            return Char_16_C           is (Char_16_C'Val (Char_16'Pos   (item)));
  function To_Char_16_C           (Item : Char_8_C)           return Char_16_C           is (Char_16_C'Val (Char_8_C'Pos  (item)));
  function To_Char_16_C           (Item : Char_8)             return Char_16_C           is (Char_16_C'Val (Char_8'Pos    (item)));
  function To_Char_16             (Item : Char_16_C)          return Char_16             is (Char_16'Val   (Char_16_C'Pos (Item)));
  function To_Char_16             (Item : Char_8_C)           return Char_16             is (Char_16'Val   (Char_8_C'Pos  (Item)));
  function To_Char_16             (Item : Char_8)             return Char_16             is (Char_16'Val   (Char_8'Pos    (Item)));

  function To_Ptr_Const_Char_8_C  (Item : Str_8)               return Ptr_Const_Char_8_C;
  function To_Ptr_Const_Char_16_C (Item : Str_16)              return Ptr_Const_Char_16_C;
  function To_Ptr_Const_Char_16_C (Item : Str_16_Complex)      return Ptr_Const_Char_16_C;
  function To_Ptr_Char_8_C        (Item : Str_8_C)             return Ptr_Char_8_C;
  function To_Ptr_Char_16_C       (Item : Str_16)              return Ptr_Char_16_C;
  function To_Char_8              (Item : Char_16)             return Char_8;
  function To_Char_8              (Item : Char_8_C)            return Char_8;
  function To_Char_8              (Item : Char_16_C)           return Char_8;
  function To_Char_8_C            (Item : Char_16)             return Char_8_C;
  function To_Char_8_C            (Item : Char_16_C)           return Char_8_C;
  function To_Char_8_C            (Item : Char_8)              return Char_8_C;
  function To_Char_16             (Item : Char_16_C)           return Char_16;
  function To_Char_16             (Item : Char_8_C)            return Char_16;
  function To_Char_16             (Item : Char_8)              return Char_16;
  function To_Char_16_C           (Item : Char_16)             return Char_16_C;
  function To_Char_16_C           (Item : Char_8_C)            return Char_16_C;
  function To_Char_16_C           (Item : Char_8)              return Char_16_C;
  function To_Str_8               (Item : Str_16)              return Str_8;
  function To_Str_8_C             (Item : Str_8)               return Str_8_C;
  function To_Str_8               (Item : Str_8_C)             return Str_8;
  function To_Str_8               (Item : Ptr_Const_Char_8_C)  return Str_8;
  function To_Str_8               (Item : Str_8_Complex)       return Str_8          renames To_Str;
  function To_Str_8_Complex       (Item : Str_8)               return Str_8_Complex  renames To_Complex_Str;
  function To_Str_16              (Item : Str_16_Complex)      return Str_16         renames To_Wide_Str;
  function To_Str_16_Complex      (Item : Str_16)              return Str_16_Complex renames To_Complex_Wide_Str;
  function To_Str_16_Complex      (Item : Char_16)             return Str_16_Complex;
  function To_Str_16_C            (Item : Str_16_Complex)      return Str_16_C;    
  function To_Str_16_C            (Item : Str_16)              return Str_16_C;
  function To_Str_16              (Item : Str_8_C)             return Str_16;
  function To_Str_16              (Item : Str_8)               return Str_16;
  function To_Str_16              (Item : Str_16_C)            return Str_16;
  function To_Str_16              (Item : Char_8)              return Str_16;
  function To_Str_16              (Item : Char_16)             return Str_16;
  function To_Str_16              (Item : Ptr_Const_Char_16_C) return Str_16;
  function To_Str_16              (Item : Ptr_Const_Char_8_C)  return Str_16;


  function Split                     (Item : Str_16; On : Str_16 := " ") return Array_Str_16_Complex;
  C_TRUE                   : constant Int_32_Signed_C := 1;
  C_FALSE                  : constant Int_32_Signed_C := 0;
  CHARACTER_16_REPLACEMENT : constant Char_8          := '~';
  WORD_SIZE_IMAGE          : constant Str_8           := WORD_SIZE'Img (WORD_SIZE'Img'First + 1..WORD_SIZE'Img'Last);
  END_LINE_8               : constant Str_8           := Ada.Chars.Latin_1.CR & Ada.Chars.Latin_1.LF;
  END_LINE_16              : constant Str_16          := To_Str_16 (END_LINE_8);
  TAB_8                    : constant Str_8           := "" & Ada.Chars.Latin_1.HT;
  TAB_16                   : constant Str_16          := To_Str_16 (TAB_8);
  NULL_STRING_8            : constant Str_8           := "";
  NULL_STRING_8_C          : constant Str_8_C         := "";
  NULL_STRING_8_UNBOUNDED  : constant Str_8_Complex   := NULL_UNBOUNDED_STRING;
  NULL_STRING_16           : constant Str_16          := "";
  NULL_STRING_16_C         : constant Str_16_C        := To_Str_16_C (NULL_STRING_16);
  NULL_STRING_16_UNBOUNDED : constant Str_16_Complex  := NULL_UNBOUNDED_WIDE_STRING;
  NULL_CHARACTER_8         : constant Char_8          := ASCII.NUL;
  NULL_CHARACTER_8_C       : constant Char_8_C        := Interfaces.C.NUL;
  NULL_CHARACTER_16        : constant Char_16         := Char_16'Val   (Char_8'Pos   (NULL_CHARACTER_8));
  NULL_CHARACTER_16_C      : constant Char_16_C       := Char_16_C'Val (Char_8_C'Pos (NULL_CHARACTER_8_C));

  -------------
  -- Parsing --
  -------------

  procedure Save (Name : Str_16; Item : Array_Stream_Element);
  function Load  (Name : Str_16) return Array_Stream_Element;
  generic
    type Enumerated_Format is (<>);
    type T is private;
  package Handler is
      procedure Save (Name : Str_16; Item : T);
      function Load  (Name : Str_16) return T;
      generic
        Kind       : Enumerated_Format;
        Save       : access procedure (Name : Str_16; Item : T);
        Load       : access function  (Name : Str_16) return T;
        Extensions : Array_Str_16;
      package Format is end;
    end;
  generic
    Path               : Str_16;
    Comment_Singleline : Str_16 := "//"; 
    Comment_Multiline  : Array_Str_16_Complex (1..2) := ("/*", "*/");
    Separator          : Str_16 := " ";
    Tab_Replacement    : Str_16 := " ";
  package Parser is
      function At_End return Bool;
      function Next   return Str_16;
      function Next   return Str_16_Complex;
      function Next   return Float_64_Real;
      function Next   (Starting, Ending : Str_16) return Str_16_Complex;
      procedure Next  (Starting, Ending : Str_16);
      procedure Next  (Number_To_Skip : Int_32_Positive := 1);
      procedure Next  (Text : Str_16);
    end;

  -----------
  -- Timer --
  -----------

  type Timer_State is private;
  function Get_Start_Time return Time;
  function Get_Duration   (Timer :        Timer_State) return Duration;
  procedure Start         (Timer : in out Timer_State);
  procedure Stop          (Timer : in out Timer_State);
private
  type Timer_State is record
      Start      : Time;
      Last       : Duration := 0.0;
      Is_Stopped : Bool     := False;
    end record;
end;